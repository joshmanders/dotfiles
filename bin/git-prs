#! /usr/bin/env bash

source _git-common.sh

function main () {
  local repo=$(origin_url)
  local cmd="${1:-help}"
  shift

  case $cmd in
    help) help;;
    checkout) checkout_pr "${repo}" "${1}";;
  esac
}

function help () {
  local script=$(script_name "${0}")
cat << EOD
  Usage: ${script} <command> [param1, param2, ...]

  Commands:
    checkout  Checkout pull request by ID from GitHub.
    help      Show this messsage.

  Examples:
    $ ${script} checkout 123

EOD
exit 0
}

function checkout_pr () {
  local repo="${1}"
  local pr="${2}"
  echo "Fetching PR #{$pr} from ${repo} as pr-${pr}."
  git fetch origin "pull/${pr}/head:pr-${pr}"
  echo "Checking out pr-${pr}."
  git checkout "pr-${pr}"
  exit 0
}

main "$@"
